<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro de Cliente</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    .container{max-width:780px;margin:40px auto;padding:24px;border:1px solid #eee;border-radius:12px}
    .grid{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .grid-1{grid-template-columns:1fr}
    .hidden{display:none}
    label{display:block;margin:10px 0 4px}
    input,select{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
    button{padding:10px 14px;border:0;border-radius:8px;cursor:pointer}
    .primary{background:#111;color:#fff}
    .error{background:#ffe8e8;color:#b71c1c;padding:8px 10px;border-radius:8px;margin:8px 0}
    .success{background:#e8ffe8;color:#1b5e20;padding:8px 10px;border-radius:8px;margin:8px 0}
    .muted{color:#666;font-size:.9rem}
  </style>
</head>
<body>
  <div class="container">
    <h2>Cadastro de Cliente</h2>
    <div id="msg" class="hidden"></div>

    <form id="cadForm" class="grid">
      <div class="grid-1">
        <label>Nome completo</label>
        <input id="nomeCompleto" required />
      </div>

      <div>
        <label>E-mail</label>
        <input id="email" type="email" required />
      </div>
      <div>
        <label>CPF</label>
        <input id="cpf" required />
      </div>

      <div>
        <label>Data de nascimento</label>
        <input id="dataNascimento" type="date" />
      </div>
      <div>
        <label>Gênero</label>
        <select id="genero">
          <option value="">Selecione…</option>
          <option value="FEMININO">Feminino</option>
          <option value="MASCULINO">Masculino</option>
          <option value="OUTRO">Outro</option>
        </select>
      </div>

      <div>
        <label>Senha</label>
        <input id="senha" type="password" required />
      </div>
      <div>
        <label>Confirmar senha</label>
        <input id="confirmaSenha" type="password" required />
      </div>

      <div class="grid-1"><h3>Endereço de faturamento</h3></div>

      <div>
        <label>CEP</label>
        <input id="fatCep" required />
      </div>
      <div>
        <label>Número</label>
        <input id="fatNumero" required />
      </div>
      <div class="grid-1">
        <label>Complemento</label>
        <input id="fatComplemento" />
      </div>

      <div class="grid-1"><h3>Endereço de entrega (opcional – se vazio, copia o FAT)</h3></div>

      <div>
        <label>CEP</label>
        <input id="entCep" />
      </div>
      <div>
        <label>Número</label>
        <input id="entNumero" />
      </div>
      <div class="grid-1">
        <label>Complemento</label>
        <input id="entComplemento" />
      </div>

      <div class="grid-1" style="margin-top:8px">
        <button class="primary" type="submit">Criar conta</button>
        <a href="cliente-login.html" class="muted" style="margin-left:12px">Já tenho conta</a>
      </div>
    </form>

    <p class="muted" style="margin-top:12px">
      Os campos de logradouro/bairro/cidade/UF serão preenchidos automaticamente no backend (ViaCEP).
    </p>
  </div>

  <!-- troque só o <script> final do arquivo que te passei antes -->
<script src="js/cliente-auth.js"></script>
<script>
  const elMsg = document.getElementById("msg");
  function showMsg(text, ok=false){
    elMsg.className = ok ? "success" : "error";
    setText(elMsg, text);
    show(elMsg);
    setTimeout(()=>hide(elMsg), 6000);
  }

  document.getElementById("cadForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    try {
      const payload = {
        nomeCompleto: document.getElementById("nomeCompleto").value.trim(),
        email: document.getElementById("email").value.trim(),
        cpf: document.getElementById("cpf").value.replace(/\D/g, ""),
        dataNascimento: document.getElementById("dataNascimento").value || null,
        genero: document.getElementById("genero").value || null,
        senha: document.getElementById("senha").value,
        confirmaSenha: document.getElementById("confirmaSenha").value,
        fatCep: document.getElementById("fatCep").value,
        fatNumero: document.getElementById("fatNumero").value,
        fatComplemento: document.getElementById("fatComplemento").value || null,
        entCep: document.getElementById("entCep").value || null,
        entNumero: document.getElementById("entNumero").value || null,
        entComplemento: document.getElementById("entComplemento").value || null,
      };

      await ClienteAuth.doRegister(payload);
      showMsg("Conta criada! Redirecionando para o login…", true);
      setTimeout(() => window.location.href = "cliente-login.html", 1200);
    } catch (err) {
      showMsg(err.detail || "Não foi possível criar a conta");
    }
  });
</script>

</body>
</html>
